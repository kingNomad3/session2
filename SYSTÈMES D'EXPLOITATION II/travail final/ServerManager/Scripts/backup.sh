#!/bin/bash

# Répertoire de sauvegarde
backup_dir="/usr/local/backups"

# Vérifier si le répertoire de sauvegarde existe
if [ -d "$backup_dir" ]
 then
    echo "Le répertoire de sauvegarde existe déjà."
else
    mkdir -p "$backup_dir"
    echo "Le répertoire de sauvegarde a été créé."
fi


# Nom du fichier de sauvegarde basé sur la date et l'heure actuelle
backup_dossier="$(date +'%Y-%m-%d %H%M').tar.gz"

# Chemin complet du fichier de sauvegarde
backup_chemin="$backup_dir/$backup_dossier"

# https://stackoverflow.com/questions/50338201/how-to-compress-and-tar-a-folder-in-linux
# Effectuer la sauvegarde en utilisant tar
tar -czvf "$backup_path" /home/usager

# Créer le lien symbolique vers le dossier Web
ln -s "$backup_path" /var/www/html/Web/backups

# Afficher le message avec le lien de téléchargement
echo "La copie de sauvegarde a été créée avec succès."
echo "<a href=\"/backups/$(basename "$backup_chemin")\">$(basename "$backup_chemin")</a>"