#!/bin/bash
# Afficher les usagers qui sont UID 1000 et plus

# https://stackoverflow.com/questions/43103186/bash-script-grep-the-etc-file-for-user-information
# Parcourir la liste des utilisateurs
while IFS=':' read -r username group uid home_directory ; do
    # Enlève le nobody,superuser et le nom choisie 
    if [[ "$username" != "nobody" && "$username" != "$USER" && "$username" != "sshAdmin" ]]; then
    #   vérifie le IUD
        if ((uid >= 1000)); then
            # prend le groupe du user
            group_name=$(id -gn "$username")

            # l'espace utiliser par le user
            espace=$(du -sh /home/"$username" | awk '{print $1}')

            # vérifié si le compte est verrouillé 
            if [[ $(grep "^$username:" /etc/shadow | cut -d: -f2) == "!"* ]]; then
                locked="verrouillé"
            else
                locked=""
            fi

            # affichage
            echo "<p>- $username: $group_name ($espace) $locked</p>"
        fi
    fi
    # donne le chemin
done < /etc/passwd







