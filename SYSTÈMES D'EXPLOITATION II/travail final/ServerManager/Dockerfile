# syntax=docker/dockerfile:1

FROM ubuntu/apache2:latest

RUN apt update
RUN apt upgrade -y
RUN apt install -y php libapache2-mod-php sudo apache2-utils git wget openssh-server
RUN a2enmod rewrite

WORKDIR /var/www/html
COPY . .

RUN mv -f /var/www/html/000-default.conf /etc/apache2/sites-available/
RUN usermod -aG sudo www-data
RUN chmod 755 /var/www/html/Scripts/*.sh

RUN echo "Defaults:www-data !requiretty" >> /etc/sudoers
RUN echo "www-data        ALL=(ALL)       NOPASSWD:/var/www/html/Scripts/" >> /etc/sudoers

EXPOSE 22